#include "vop.h"
#include "gic.h"

static int vop_irq_handle(){
	printf("vop irq\n");
	return 0;
}

int vop_enable(){
	VOP_REG_SET(VOP_WIN0_CTRL0,0x1,0x15,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x1,0x16,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x7,0x1,0x0);
	VOP_REG_SET(VOP_WIN0_VIR,0x3fff,0x0,0x500);
	VOP_REG_SET(VOP_WIN0_YRGB_MST,0xffffffff,0x0,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x7,0x4,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x7,0x5,0x4);
	VOP_REG_SET(VOP_WIN0_SCL_FACTOR_YRGB,0xffff,0x0,0x1000);
	VOP_REG_SET(VOP_WIN0_SCL_FACTOR_YRGB,0xffff,0x10,0x1000);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x1,0x4,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x1,0x5,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x10,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x12,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x14,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x1,0x17,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x1,0x16,0x1);
	VOP_REG_SET(VOP_WIN0_ACT_INFO,0x1fff1fff,0x0,0x3ff04ff);
	VOP_REG_SET(VOP_WIN0_DSP_INFO,0xfff0fff,0x0,0x3ff04ff);
	VOP_REG_SET(VOP_WIN0_DSP_ST,0x1fff1fff,0x0,0x290168);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x1,0xc,0x0);
	VOP_REG_SET(VOP_WIN0_SRC_ALPHA_CTRL,0xffff,0x0,0x0);
	VOP_REG_SET(VOP_WIN0_SRC_ALPHA_CTRL,0xff,0x10,0xff);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x3,0xa,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x9,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x5,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x8,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x1,0x0,0x1);

	VOP_REG_SET(VOP_DSP_CTRL0,0x1f,0xc,0x0);
	VOP_REG_SET(VOP_DSP_CTRL0,0xf,0x0,0xf);
	VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x2,0x0);
	VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x1,0x0);
	VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x1,0x0);
	VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x4,0x0);
	VOP_REG_SET(VOP_DSP_CTRL0,0x1,0x8,0x0);
	VOP_REG_SET(VOP_SYS_CTRL,0x1,0x10,0x0);//overlay

	VOP_REG_SET(VOP_POST_SCL_CTRL,0x1,0x2,0x0);
	VOP_REG_SET(VOP_DSP_BG,0xffffffff,0x0,0x0);
	VOP_REG_SET(VOP_BCSH_CTRL,0x1,0x4,0x0);
	VOP_REG_SET(VOP_BCSH_CTRL,0x1,0x0,0x0);
	VOP_REG_SET(VOP_BCSH_CTRL,0x3,0x6,0x1);
	VOP_REG_SET(VOP_BCSH_CTRL,0x3,0x2,0x1);
	VOP_REG_SET(VOP_BCSH_CTRL,0x1,0x0,0x0);
	VOP_REG_SET(VOP_DSP_CTRL1,0xff,0x8,0x18);
	VOP_REG_SET(VOP_POST_DSP_HACT_INFO,0x1fff1fff,0x0,0x1680668);
	VOP_REG_SET(VOP_POST_DSP_VACT_INFO,0x1fff1fff,0x0,0x290429);
	VOP_REG_SET(VOP_POST_SCL_FACTOR_YRGB,0xffffffff,0x0,0x10001000);
	VOP_REG_SET(VOP_POST_SCL_CTRL,0x3,0x0,0x0);

	VOP_REG_SET(VOP_SYS_CTRL,0x1,0x15,0x1);
	//VOP_REG_SET(VOP_SYS_CTRL,0x1,0x15,0x0);

	VOP_REG_SET(VOP_HDR2DR_CTRL,0x1,0x0,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x0,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x4,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x1,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x2,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x3,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x5,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x6,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x7,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x1f,0x1);
	VOP_CONFIG_DONE();

	VOP_REG_SET(VOP_INTR_CLEAR0,0xffffffff,0x0,0x90029002);
	VOP_REG_SET(VOP_INTR_EN0,0xffffffff,0x0,0x90029002);

	VOP_REG_SET(VOP_SYS_CTRL1,0x1,0x1c,0x0);
	VOP_REG_SET(VOP_SYS_CTRL1,0x1,0x1b,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x1,0x15,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x1,0x16,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x7,0x1,0x0);
	VOP_REG_SET(VOP_WIN0_VIR,0x3fff,0x0,0x500);
	VOP_REG_SET(VOP_WIN0_YRGB_MST,0xffffffff,0x0,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x7,0x4,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x7,0x5,0x4);
	VOP_REG_SET(VOP_WIN0_SCL_FACTOR_YRGB,0xffff,0x0,0x1000);
	VOP_REG_SET(VOP_WIN0_SCL_FACTOR_YRGB,0xffff,0x10,0x1000);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x1,0x4,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x1,0x5,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x10,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x12,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x14,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x1,0x17,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL1,0x1,0x16,0x1);

	VOP_REG_SET(VOP_WIN0_ACT_INFO,0x1fff1fff,0x0,0x3ff04ff);
	VOP_REG_SET(VOP_WIN0_DSP_INFO,0xfff0fff,0x0,0x3ff04ff);
	VOP_REG_SET(VOP_WIN0_DSP_ST,0x1fff1fff,0x0,0x290168);

	VOP_REG_SET(VOP_WIN0_CTRL0,0x1,0xc,0x0);
	VOP_REG_SET(VOP_WIN0_SRC_ALPHA_CTRL,0xffff,0x0,0x0);
	VOP_REG_SET(VOP_WIN0_SRC_ALPHA_CTRL,0xff,0x10,0xff);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x3,0xa,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x9,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x5,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x8,0x0);
	VOP_REG_SET(VOP_WIN0_CTRL0,0x1,0x0,0x1);
	VOP_REG_SET(VOP_DSP_CTRL0,0x1f,0xc,0x0);
	VOP_REG_SET(VOP_DSP_CTRL0,0xf,0x0,0xf);
	VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x2,0x0);
	VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x1,0x0);
	VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x1,0x0);
	VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x4,0x0);
	VOP_REG_SET(VOP_DSP_CTRL0,0x1,0x8,0x0);
	VOP_REG_SET(VOP_SYS_CTRL,0x1,0x10,0x0);//overlay
	VOP_REG_SET(VOP_POST_SCL_CTRL,0x1,0x2,0x0);

	VOP_REG_SET(VOP_DSP_BG,0xffffffff,0x0,0x0);

	VOP_REG_SET(VOP_BCSH_CTRL,0x1,0x4,0x0);
	VOP_REG_SET(VOP_BCSH_CTRL,0x1,0x0,0x0);
	VOP_REG_SET(VOP_BCSH_CTRL,0x3,0x6,0x1);
	VOP_REG_SET(VOP_BCSH_CTRL,0x3,0x2,0x1);
	VOP_REG_SET(VOP_BCSH_COLOR_BAR,0x1,0x0,0x0);
	VOP_REG_SET(VOP_DSP_CTRL1,0xff,0x8,0x18);
	VOP_REG_SET(VOP_POST_DSP_HACT_INFO,0x1fff1fff,0x0,0x1680668);
	VOP_REG_SET(VOP_POST_DSP_VACT_INFO,0x1fff1fff,0x0,0x290429);
	VOP_REG_SET(VOP_POST_SCL_FACTOR_YRGB,0xfffFffff,0x0,0x10001000);
	VOP_REG_SET(VOP_POST_SCL_CTRL,0x3,0x0,0x0);
	VOP_REG_SET(VOP_HDR2DR_CTRL,0x1,0x0,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x0,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x4,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x1,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x2,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x3,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x5,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x6,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x7,0x0);
	VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x1f,0x1);
	VOP_CONFIG_DONE();

	//gic_register_irq_routine(32+32,vop_irq_handle,IRQ_TYPE_LEVEL_HIGH);
	//gic_register_irq_routine(32+5,vop_irq_handle,IRQ_TYPE_LEVEL_HIGH);
	return 0;
}

int vop_init(){
	VOP_REG_SET(VOP_SYS_CTRL,0x1,0xb,0x1);
    VOP_REG_SET(VOP_DSP_CTRL0,0x3,0x12,0x0);

    VOP_REG_SET(VOP_SYS_CTRL1,0x1f,0xd,0x1e);//aux_outstanding
    VOP_REG_SET(VOP_SYS_CTRL1,0x1,0xc,0x1);//aux_outstanding

    VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x6,0x1);


    VOP_REG_SET(VOP_WIN0_CTRL2,0xff,0x0,0x21);
    VOP_REG_SET(VOP_WIN1_CTRL2,0xff,0x0,0x43);
    VOP_REG_SET(VOP_WIN2_CTRL2,0xff,0x0,0x65);

    VOP_REG_SET(VOP_INTR_CLEAR0,0xfe00fe0,0x0,0xfe00fe0);
    VOP_REG_SET(VOP_INTR_EN0,0xfe00fe0,0x0,0xfe00fe0);

    VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x10,0x0);
    VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x12,0x0);
    VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x18,0x0);
    VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x1a,0x0);
    VOP_REG_SET(VOP_WIN0_CTRL0,0x1,0x0,0x0);
    VOP_REG_SET(VOP_WIN1_CTRL1,0x3,0x10,0x0);
    VOP_REG_SET(VOP_WIN1_CTRL1,0x3,0x12,0x0);
    VOP_REG_SET(VOP_WIN1_CTRL1,0x3,0x18,0x0);
    VOP_REG_SET(VOP_WIN1_CTRL1,0x3,0x1a,0x0);
    VOP_REG_SET(VOP_WIN1_COLOR_KEY,0x1,0x0,0x0);
    VOP_REG_SET(VOP_WIN2_CTRL1,0x3,0x10,0x0);
    VOP_REG_SET(VOP_WIN2_CTRL1,0x3,0x12,0x0);
    VOP_REG_SET(VOP_WIN2_CTRL1,0x3,0x18,0x0);
    VOP_REG_SET(VOP_WIN2_CTRL1,0x3,0x1a,0x0);
    VOP_REG_SET(VOP_WIN2_CTRL0,0x1,0x0,0x0);
    VOP_REG_SET(VOP_SYS_CTRL,0x1,0x16,0x0);
    VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x10,0x0);
    VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x12,0x0);
    VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x18,0x0);
    VOP_REG_SET(VOP_WIN0_CTRL1,0x3,0x1a,0x0);
    VOP_REG_SET(VOP_WIN0_CTRL0,0x1,0x0,0x0);
    VOP_REG_SET(VOP_WIN1_CTRL1,0x3,0x10,0x0);
    VOP_REG_SET(VOP_WIN1_CTRL1,0x3,0x12,0x0);
    VOP_REG_SET(VOP_WIN1_CTRL1,0x3,0x18,0x0);
    VOP_REG_SET(VOP_WIN1_CTRL1,0x3,0x1a,0x0);
    VOP_REG_SET(VOP_WIN1_COLOR_KEY,0x1,0x0,0x0);
    VOP_REG_SET(VOP_WIN2_CTRL1,0x3,0x10,0x0);
    VOP_REG_SET(VOP_WIN2_CTRL1,0x3,0x12,0x0);
    VOP_REG_SET(VOP_WIN2_CTRL1,0x3,0x18,0x0);
    VOP_REG_SET(VOP_WIN2_CTRL1,0x3,0x1a,0x0);
    VOP_REG_SET(VOP_WIN2_CTRL0,0x1,0x0,0x0);
    VOP_CONFIG_DONE();

    VOP_REG_SET(VOP_SYS_CTRL,0x1,0xd,0x1);
    VOP_REG_SET(VOP_DSP_CTRL1,0x7,0x14,0x3);
    VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x17,0x1);
    VOP_REG_SET(VOP_DSP_CTRL0,0x1f,0xc,0x0);
    VOP_REG_SET(VOP_DSP_CTRL0,0xf,0x0,0xf);
    VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x2,0x0);
    VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x1,0x0);
    VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x1,0x0);
    VOP_REG_SET(VOP_DSP_CTRL1,0x1,0x4,0x0);
    VOP_REG_SET(VOP_DSP_CTRL0,0x1,0x8,0x0);
    VOP_REG_SET(VOP_SYS_CTRL,0x1,0x10,0x0);//overlay
    VOP_REG_SET(VOP_POST_SCL_CTRL,0x1,0x2,0x0);
    VOP_REG_SET(VOP_DSP_BG,0xffffffff,0x0,0x0);

    VOP_REG_SET(VOP_DSP_HTOTAL_HS_END,0x1fff1fff,0x0,0x6980070);
    VOP_REG_SET(VOP_DSP_HACT_ST_END,0x1fff1fff,0x0,0x1680668);
    VOP_REG_SET(VOP_POST_DSP_HACT_INFO,0x1fff1fff,0x0,0x1680668);
    VOP_REG_SET(VOP_DSP_VACT_ST_END,0x1fff1fff,0x0,0x290429);
    VOP_REG_SET(VOP_POST_DSP_VACT_INFO,0x1fff1fff,0x0,0x290429);

    VOP_REG_SET(VOP_DSP_CTRL0,0x1,0xa,0x0);
    VOP_REG_SET(VOP_DSP_CTRL0,0x1,0x5,0x0);
    VOP_REG_SET(VOP_DSP_CTRL0,0x1,0x17,0x0);
    VOP_REG_SET(VOP_DSP_CTRL0,0x1,0x16,0x0);

    VOP_REG_SET(VOP_LINE_FLAG,0xffff,0x0,0x429);
	VOP_REG_SET(VOP_LINE_FLAG,0xffff,0x10,0x3ea);

    VOP_REG_SET(VOP_DSP_VTOTAL_VS_END,0x1fff1fff,0x0,0x42a0003);
    VOP_REG_SET(VOP_DSP_CTRL0,0x1,0x4,0x0);
    VOP_REG_SET(VOP_SDR2HDR_CTRL,0x1,0x1f,0x1);
    return 0;
}